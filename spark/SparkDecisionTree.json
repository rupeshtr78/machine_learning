{"paragraphs":[{"text":"%spark.pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.mllib.regression import LabeledPoint\nfrom pyspark.mllib.tree import DecisionTree\nfrom pyspark import SparkConf, SparkContext\nfrom numpy import array","user":"anonymous","dateUpdated":"2020-01-09T14:46:43-0600","config":{"colWidth":12,"fontSize":10,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602374921_662988064","id":"20200109-143934_181563541","dateCreated":"2020-01-09T14:39:34-0600","dateStarted":"2020-01-09T14:40:15-0600","dateFinished":"2020-01-09T14:40:15-0600","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:74159"},{"text":"%spark.pyspark\ndef binary(YN):\n    if (YN == 'Y'):\n        return 1\n    else:\n        return 0","user":"anonymous","dateUpdated":"2020-01-09T14:40:53-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602428571_-280708365","id":"20200109-144028_1868043123","dateCreated":"2020-01-09T14:40:28-0600","dateStarted":"2020-01-09T14:40:53-0600","dateFinished":"2020-01-09T14:40:53-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74160"},{"text":"%spark.pyspark\ndef mapEducation(degree):\n    if (degree == 'BS'):\n        return 1\n    elif (degree =='MS'):\n        return 2\n    elif (degree == 'PhD'):\n        return 3\n    else:\n        return 0","user":"anonymous","dateUpdated":"2020-01-09T14:41:04-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602453913_-693085959","id":"20200109-144053_1307890434","dateCreated":"2020-01-09T14:40:53-0600","dateStarted":"2020-01-09T14:41:04-0600","dateFinished":"2020-01-09T14:41:04-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74161"},{"text":"%spark.pyspark\ndef createLabeledPoints(fields):\n    yearsExperience = int(fields[0])\n    employed = binary(fields[1])\n    previousEmployers = int(fields[2])\n    educationLevel = mapEducation(fields[3])\n    topTier = binary(fields[4])\n    interned = binary(fields[5])\n    hired = binary(fields[6])\n\n    return LabeledPoint(hired, array([yearsExperience, employed,\n        previousEmployers, educationLevel, topTier, interned]))","user":"anonymous","dateUpdated":"2020-01-09T14:41:17-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602464471_-599840141","id":"20200109-144104_1162883186","dateCreated":"2020-01-09T14:41:04-0600","dateStarted":"2020-01-09T14:41:17-0600","dateFinished":"2020-01-09T14:41:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74162"},{"text":"%spark.pyspark\nrawData = sc.textFile(\"/home/hyper/python/MLCourse/PastHires.csv\")\nheader = rawData.first()\nrawData = rawData.filter(lambda x:x != header)","user":"anonymous","dateUpdated":"2020-01-09T14:43:13-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602477394_746378350","id":"20200109-144117_1846790020","dateCreated":"2020-01-09T14:41:17-0600","dateStarted":"2020-01-09T14:43:13-0600","dateFinished":"2020-01-09T14:43:17-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74163"},{"text":"%spark.pyspark\ncsvData = rawData.map(lambda x: x.split(\",\"))","user":"anonymous","dateUpdated":"2020-01-09T14:44:01-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602593298_-1117270432","id":"20200109-144313_596137573","dateCreated":"2020-01-09T14:43:13-0600","dateStarted":"2020-01-09T14:44:01-0600","dateFinished":"2020-01-09T14:44:01-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74164"},{"text":"%spark.pyspark\ntrainingData = csvData.map(createLabeledPoints)","user":"anonymous","dateUpdated":"2020-01-09T14:44:13-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602616011_784524766","id":"20200109-144336_133718151","dateCreated":"2020-01-09T14:43:36-0600","dateStarted":"2020-01-09T14:44:13-0600","dateFinished":"2020-01-09T14:44:13-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74165"},{"text":"%spark.pyspark\ntestCandidates = [ array([10, 1, 3, 1, 0, 0])]\ntestData = sc.parallelize(testCandidates)","user":"anonymous","dateUpdated":"2020-01-09T14:44:32-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602653835_-1219638493","id":"20200109-144413_38859878","dateCreated":"2020-01-09T14:44:13-0600","dateStarted":"2020-01-09T14:44:32-0600","dateFinished":"2020-01-09T14:44:32-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74166"},{"text":"%spark.pyspark\nmodel = DecisionTree.trainClassifier(trainingData, numClasses=2,\n                                     categoricalFeaturesInfo={1:2, 3:4, 4:2, 5:2},\n                                     impurity='gini', maxDepth=5, maxBins=32)","user":"anonymous","dateUpdated":"2020-01-09T14:44:44-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602672091_-1580160239","id":"20200109-144432_517937936","dateCreated":"2020-01-09T14:44:32-0600","dateStarted":"2020-01-09T14:44:44-0600","dateFinished":"2020-01-09T14:44:48-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74167"},{"text":"%spark.pyspark\npredictions = model.predict(testData)","user":"anonymous","dateUpdated":"2020-01-09T14:45:06-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578602684559_265837952","id":"20200109-144444_1925341986","dateCreated":"2020-01-09T14:44:44-0600","dateStarted":"2020-01-09T14:45:06-0600","dateFinished":"2020-01-09T14:45:06-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74168"},{"text":"%spark.pyspark\nprint('Hire prediction:')\nresults = predictions.collect()\nfor result in results:\n    print(result)","user":"anonymous","dateUpdated":"2020-01-09T14:45:45-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Hire prediction:\n1.0\n"}]},"apps":[],"jobName":"paragraph_1578602706623_1685613117","id":"20200109-144506_690384956","dateCreated":"2020-01-09T14:45:06-0600","dateStarted":"2020-01-09T14:45:45-0600","dateFinished":"2020-01-09T14:45:45-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74169"},{"text":"%spark.pyspark\nprint('Learned classification tree model:')\nprint(model.toDebugString())","user":"anonymous","dateUpdated":"2020-01-09T14:46:00-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Learned classification tree model:\nDecisionTreeModel classifier of depth 4 with 9 nodes\n  If (feature 1 in {0.0})\n   If (feature 5 in {0.0})\n    If (feature 0 <= 0.0)\n     If (feature 3 in {1.0})\n      Predict: 0.0\n     Else (feature 3 not in {1.0})\n      Predict: 1.0\n    Else (feature 0 > 0.0)\n     Predict: 0.0\n   Else (feature 5 not in {0.0})\n    Predict: 1.0\n  Else (feature 1 not in {0.0})\n   Predict: 1.0\n\n"}]},"apps":[],"jobName":"paragraph_1578602720114_-1631625453","id":"20200109-144520_1005266057","dateCreated":"2020-01-09T14:45:20-0600","dateStarted":"2020-01-09T14:46:00-0600","dateFinished":"2020-01-09T14:46:00-0600","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74170"},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2020-01-09T14:46:00-0600","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578602760299_-1273351359","id":"20200109-144600_587418623","dateCreated":"2020-01-09T14:46:00-0600","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:74171"}],"name":"SparkDecisionTree","id":"2EWD4HYC8","noteParams":{},"noteForms":{},"angularObjects":{"python:shared_process":[],"sh:shared_process":[],"pig:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}